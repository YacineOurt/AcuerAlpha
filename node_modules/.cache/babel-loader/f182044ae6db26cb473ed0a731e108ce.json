{"ast":null,"code":"import * as React from 'react';\nimport { forwardRef, useImperativeHandle, useRef, useEffect } from 'react';\nimport { applyReactStyle } from '../utils/apply-react-style';\nimport useControl from './use-control';\nvar GeolocateControl = forwardRef(function (props, ref) {\n  var thisRef = useRef({\n    props: props\n  });\n  var ctrl = useControl(function (_ref) {\n    var mapLib = _ref.mapLib;\n    var gc = new mapLib.GeolocateControl(props); // Hack: fix GeolocateControl reuse\n    // When using React strict mode, the component is mounted twice.\n    // GeolocateControl's UI creation is asynchronous. Removing and adding it back causes the UI to be initialized twice.\n\n    var setupUI = gc._setupUI;\n\n    gc._setupUI = function (args) {\n      if (!gc._container.hasChildNodes()) {\n        setupUI(args);\n      }\n    };\n\n    gc.on('geolocate', function (e) {\n      var _a, _b;\n\n      (_b = (_a = thisRef.current.props).onGeolocate) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    });\n    gc.on('error', function (e) {\n      var _a, _b;\n\n      (_b = (_a = thisRef.current.props).onError) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    });\n    gc.on('outofmaxbounds', function (e) {\n      var _a, _b;\n\n      (_b = (_a = thisRef.current.props).onOutOfMaxBounds) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    });\n    gc.on('trackuserlocationstart', function (e) {\n      var _a, _b;\n\n      (_b = (_a = thisRef.current.props).onTrackUserLocationStart) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    });\n    gc.on('trackuserlocationend', function (e) {\n      var _a, _b;\n\n      (_b = (_a = thisRef.current.props).onTrackUserLocationEnd) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n    });\n    return gc;\n  }, {\n    position: props.position\n  });\n  thisRef.current.props = props;\n  useImperativeHandle(ref, function () {\n    return {\n      trigger: function trigger() {\n        return ctrl.trigger();\n      }\n    };\n  }, []);\n  useEffect(function () {\n    // @ts-ignore\n    applyReactStyle(ctrl._container, props.style);\n  }, [props.style]);\n  return null;\n});\nGeolocateControl.displayName = 'GeolocateControl';\nexport default React.memo(GeolocateControl);","map":null,"metadata":{},"sourceType":"module"}